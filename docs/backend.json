
{
  "entities": {
    "Contrato": {
      "title": "Contrato",
      "type": "object",
      "description": "Represents an employee contract with evaluation data.",
      "properties": {
        "id_empleado": { "type": "string" },
        "nombre_completo": { "type": "string" },
        "fechas": {
          "type": "object",
          "properties": {
            "ingreso": { "type": "string", "format": "date-time" },
            "termino_contrato": { "type": "string", "format": "date-time" },
            "evaluacion_1": { "type": "string", "format": "date-time" },
            "evaluacion_2": { "type": "string", "format": "date-time" },
            "evaluacion_3": { "type": "string", "format": "date-time" }
          }
        },
        "evaluacion": {
          "type": "object",
          "properties": {
            "calificacion_texto_1": { "type": "string" },
            "calificacion_texto_2": { "type": "string" },
            "calificacion_texto_3": { "type": "string" }
          }
        },
        "indeterminado": { "type": "boolean" }
      },
      "required": ["id_empleado", "nombre_completo", "fechas"]
    },
    "Plantilla": {
      "title": "Plantilla",
      "type": "object",
      "description": "Represents an employee in the company's workforce.",
      "properties": {
          "id_empleado": { "type": "string" },
          "nombre_completo": { "type": "string" },
          "puesto": {
              "type": "object",
              "properties": {
                  "departamento": { "type": "string" },
                  "area": { "type": "string" },
                  "titulo": { "type": "string" },
                  "turno": { "type": "string" }
              }
          }
      },
      "required": ["id_empleado", "nombre_completo", "puesto"]
    },
    "Report": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Report",
      "type": "object",
      "description": "Represents a generated HR report.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the report." },
        "title": { "type": "string", "description": "The title of the report." },
        "dateGenerated": { "type": "string", "description": "The date the report was generated.", "format": "date-time" },
        "content": { "type": "string", "description": "The content of the report (e.g., summary and recommendations)." },
        "employeeIds": {
          "type": "array",
          "description": "References to Employees included in this report. (Relationship: Report 1:N Employee)",
          "items": { "type": "string" }
        }
      },
      "required": ["id", "title", "dateGenerated", "content"]
    },
    "PerfilPuesto": {
      "title": "Perfil de Puesto",
      "type": "object",
      "description": "Defines the required courses for a specific job title.",
      "properties": {
        "nombre_puesto": { "type": "string" },
        "cursos_obligatorios": {
          "type": "array",
          "items": { "type": "string" }
        },
        "fecha_actualizacion": { "type": "string", "format": "date-time" }
      },
      "required": ["nombre_puesto", "cursos_obligatorios"]
    },
    "Promocion": {
        "title": "Promocion",
        "description": "Represents an employee's promotion record and requirements.",
        "type": "object",
        "properties": {
            "id_empleado": { "type": "string"},
            "nombre": { "type": "string"},
            "puesto_actual": { "type": "string"},
            "fecha_ultimo_cambio": { "type": "string", "format": "date-time", "description": "Date of the last category change."},
            "evaluacion_desempeno": { "type": "number", "description": "Performance evaluation score (0-100)." },
            "examen_teorico": { "type": "number", "description": "Score from the theoretical exam (0-100)."},
            "cobertura_cursos": { "type": "number", "description": "Percentage of required courses completed."},
            "no_apto": { "type": "boolean", "description": "Manually marks an employee as not suitable for promotion." },
            "metadata": {
                "type": "object",
                "properties": {
                    "creado_el": { "type": "string", "format": "date-time" },
                    "actualizado_el": { "type": "string", "format": "date-time" }
                }
            }
        },
        "required": ["id_empleado", "nombre", "puesto_actual"]
    },
    "Usuario": {
        "title": "Usuario",
        "description": "Represents a platform user and their role.",
        "type": "object",
        "properties": {
            "nombre": { "type": "string" },
            "email": { "type": "string", "format": "email" },
            "role": { "type": "string", "enum": ["admin", "lector", "empleado"] },
            "requiresPasswordChange": { "type": "boolean", "description": "Flag to force password change on first login." }
        },
        "required": ["email", "role"]
    },
    "Vacacion": {
      "title": "Vacación",
      "description": "Represents a single vacation or leave entry for an employee.",
      "type": "object",
      "properties": {
        "id_empleado": { "type": "string" },
        "nombre_empleado": { "type": "string" },
        "fecha_inicio": { "type": "string", "format": "date-time" },
        "fecha_fin": { "type": "string", "format": "date-time" },
        "tipo": { "type": "string", "enum": ["Vacaciones", "Permiso", "Incapacidad", "Falta"] },
        "comentarios": { "type": "string" },
        "creado_el": { "type": "string", "format": "date-time" }
      },
      "required": ["id_empleado", "nombre_empleado", "fecha_inicio", "fecha_fin", "tipo"]
    },
    "DiaFestivo": {
      "title": "Día Festivo",
      "description": "Represents an official non-working day.",
      "type": "object",
      "properties": {
        "fecha": { "type": "string", "format": "date-time" },
        "nombre": { "type": "string" }
      },
      "required": ["fecha", "nombre"]
    },
    "Examen": {
      "title": "Examen",
      "description": "Defines an exam for a specific job profile by referencing questions.",
      "type": "object",
      "properties": {
        "puestoId": { "type": "string", "description": "Links to a 'PerfilPuesto' ID." },
        "nombre_examen": { "type": "string" },
        "preguntaIds": {
          "type": "array",
          "description": "An array of document IDs from the 'preguntas_limpias' collection.",
          "items": { "type": "string" }
        }
      },
      "required": ["puestoId", "nombre_examen", "preguntaIds"]
    },
    "IntentoExamen": {
      "title": "Intento de Examen",
      "description": "Records a single attempt of an exam by an employee.",
      "type": "object",
      "properties": {
        "id_empleado": { "type": "string" },
        "examenId": { "type": "string", "description": "The ID of the exam that was taken." },
        "fecha": { "type": "string", "format": "date-time" },
        "calificacion": { "type": "number" },
        "respuestas": {
          "type": "object",
          "description": "A map of question IDs to the selected answer key (e.g., {'pregunta123': 'A'}).",
          "additionalProperties": { "type": "string" }
        }
      },
      "required": ["id_empleado", "examenId", "fecha", "calificacion"]
    }
  },
  "auth": {
    "providers": ["password", "anonymous"]
  },
  "firestore": {
    "structure": [
      {
        "path": "/Contratos/{contratoId}",
        "definition": {
          "entityName": "Contrato",
          "schema": { "$ref": "#/entities/Contrato" },
          "description": "Stores employee contract data, including evaluation dates and scores.",
          "params": [{ "name": "contratoId", "description": "The unique identifier for the contract, typically the employee ID." }]
        }
      },
      {
        "path": "/Plantilla/{empleadoId}",
        "definition": {
            "entityName": "Plantilla",
            "schema": { "$ref": "#/entities/Plantilla" },
            "description": "Stores the main workforce data.",
            "params": [{ "name": "empleadoId", "description": "The unique identifier for the employee." }]
        }
      },
      {
        "path": "/reports/{reportId}",
        "definition": {
          "entityName": "Report",
          "schema": { "$ref": "#/entities/Report" },
          "description": "Stores HR reports. Each document represents a generated report.",
          "params": [{ "name": "reportId", "description": "The unique identifier for the report." }]
        }
      },
       {
        "path": "/perfiles_puesto/{puestoId}",
        "definition": {
          "entityName": "PerfilPuesto",
          "schema": { "$ref": "#/entities/PerfilPuesto" },
          "description": "Stores the mandatory courses for each job profile.",
          "params": [{ "name": "puestoId", "description": "The normalized job title name." }]
        }
      },
      {
        "path": "/Promociones/{empleadoId}",
        "definition": {
          "entityName": "Promocion",
          "schema": { "$ref": "#/entities/Promocion" },
          "description": "Stores promotion eligibility records for employees.",
          "params": [{ "name": "empleadoId", "description": "The unique identifier for the employee, linking to their record in Plantilla." }]
        }
      },
      {
        "path": "/Promociones/{empleadoId}/intentos_examen/{intentoId}",
        "definition": {
          "entityName": "IntentoExamen",
          "schema": { "$ref": "#/entities/IntentoExamen" },
          "description": "Stores each exam attempt for an employee.",
          "params": [
            { "name": "empleadoId", "description": "The employee ID." },
            { "name": "intentoId", "description": "Unique ID for the exam attempt." }
          ]
        }
      },
      {
        "path": "/usuarios/{usuarioId}",
        "definition": {
          "entityName": "Usuario",
          "schema": { "$ref": "#/entities/Usuario" },
          "description": "Stores platform user roles for dynamic access control.",
          "params": [{ "name": "usuarioId", "description": "The user's UID from Firebase Authentication." }]
        }
      },
       {
        "path": "/vacaciones/{vacacionId}",
        "definition": {
          "entityName": "Vacacion",
          "schema": { "$ref": "#/entities/Vacacion" },
          "description": "Stores individual leave records for all employees.",
          "params": [{ "name": "vacacionId", "description": "A unique ID for the leave record." }]
        }
      },
      {
        "path": "/dias_festivos/{diaId}",
        "definition": {
          "entityName": "DiaFestivo",
          "schema": { "$ref": "#/entities/DiaFestivo" },
          "description": "Stores official non-working days for the year.",
          "params": [{ "name": "diaId", "description": "A unique ID for the holiday, e.g., 'ano_nuevo_2024'." }]
        }
      },
      {
        "path": "/examenes/{puestoId}",
        "definition": {
          "entityName": "Examen",
          "schema": { "$ref": "#/entities/Examen" },
          "description": "Defines which questions form the exam for a specific job.",
          "params": [{ "name": "puestoId", "description": "The ID of the job profile." }]
        }
      }
    ]
  }
}
